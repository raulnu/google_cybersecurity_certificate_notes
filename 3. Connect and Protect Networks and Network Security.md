# 1	Network Architecture
## 1.1	Introduction to networks
### 1.1.1	Structure of a network
**Network**: group of connected devices

Devices can be connected with other devices via
- Cable connections
- Wireless connections

Each device has a **unique address**: 
- IP addresses 
- MAC Addresses
#### 1.1.1.1	Local Area Newtork (LAN)
A network that spans a small area like an office building, school or a home. Usually, the network then connects to the internet.
#### 1.1.1.2	Wide Area Network (WAN)
A network that spans a large geographic area like a city, state, or country.
It usually connects lots of LANs together.
### 1.1.2	Standard networking tools
- **Hub:** Network device that broadcasts information to every device on the network
- **Switch:** A device that makes connections between specific devices on a network by sending and receiving data between them. Switches can direct traffic, so are better than hubs
- **Router:** Connects multiple networks together
- **Modem:** Connects router to the internet, and brings internet access to the LAN
- **Virtualization tools:** Pieces of software that perform network operations, usually provided by cloud services
### 1.1.3	Cloud networks
**Cloud computing:** using remote servers, applications and network services that are hosted on the internet instead of on local physical devices.
**Cloud network:** a collection of servers or computers that stores resources and data in remote data centers that can be accessed via the internet
**Common cloud services**:
- Infrastructure as a Service (IaaS): Servers, networking, storage
- Platform as a Service (PaaS): Operating systems, database management and development tools
- Software as a Service (SaaS): Cloud-hosted applications
- *Common uses*:
	- On-demand storage
	- Processing power
	- Analytics
**Benefits of cloud computing:**
- Reliability
- Cost
- Scalability

## 1.2	Network communication

### 1.2.1	Data
#### 1.2.1.1	Data packets
A basic unit of information that travels from one device to another within a network
It contains information about:
- Where the packet is going (Header)
- Where it is coming from (Footer)
- The content of the message (Body)

**Header:** Contains Source and Destination IP Address, Source and Destination MAC address, Protocol Number
**Body:** Message transmitted
**Footer:** Error checking info, signal of receiving
#### 1.2.1.2	Bandwith
Amount of data a device receives every second
#### 1.2.1.3	Speed
Rate at which data packets are received or downloaded
#### 1.2.1.4	Packet sniffing
The practice of capturing and inspecting data packets across a network
### 1.2.2	TCP/IP Model
It is the standard model for internet communication.
Framework used to visualize how data is organized and transmitted across the network.
**Transmission control protocol:** An internet communication protocol that allows two devices to form a connection and stream data.
**Internet protocol model:** A set of standards used for routing and addressing data packets as they travel between devices on a network.
#### 1.2.2.1	Port
A sofware-based location that organizes the sending and receiving of data between devices on a network.
They divide network traffic into **segments**, and segments are classified among ports.
- Common ports:
	- 25 - Email (SMTP?)
	- 443 - Secure internet communication (HTTPS)
	- 20 - Large file transfers (FTP?)
#### 1.2.2.2	TCP/IP Layers
It has 4 layers:
- **Network access layer** / Data link layer (OSI Layers 1 and 2)
	- Deals with *creation of data packets* *and* their *transmission* across a network
	- Includes devices connected to physical cables and switches that direct data to its destination
	- ARP
- **Internet layer** / Network layer (OSI Layer 3)
	- Where *IP addresses are attached to data packets* to indicate the location of the sender and receiver
	- Also, focuses on how networks connect to each other
	- IP, ICMP
- **Transport layer** (OSI Layer 4)
	- Includes *protocols to control the flow of traffic* across a network
	- These protocols permit or deny communication with other devices
	- TCP, UDP
- **Application layer** (OSI Layer 5, 6 and 7)
	- Protocols determine *how data packets interact with receiving devices*
	- File transfers and email services
	- Network requests or responses
	- HTTP, SMTP, SSH, FTP, DNS

TCP/IP Model
![[image.png|451x311]]

### 1.2.3	OSI Model
The **OSI model** is a standardized concept that describes the seven layers computers use to communicate and send data over the network. Network and security professionals often use this model to communicate with each other about potential sources of problems or security threats when they occur.
It has 7 layers:

TCP/IP - OSI Relation
![[image-1.png|716x307]]

#### 1.2.3.1	Layer 1 – Physical
1. Includes the **physical hardware**: cables, hubs, modems, electrical or optical signals.
2. Converts data into a stream of **bits (0s and 1s)** that travel across the medium.
3. Defines characteristics like voltage, connectors, transmission speed, and topology.
#### 1.2.3.2	Layer 2 – Data Link
1. Controls **data transfer within the same local network (LAN)**.
2. Manages **MAC addresses**, switches, and network interface cards.
3. Protocols include **NCP, HDLC, SDLC**.
#### 1.2.3.3	Layer 3 – Network
1. Manages **addressing and routing** of packets across different networks.
2. Uses **IP addresses** to identify source and destination.
3. **Routers** operate at this layer to forward packets through the network.
#### 1.2.3.4	Layer 4 – Transport
1. Ensures **end-to-end delivery of data** between devices.
2. Performs **segmentation**: divides data into smaller blocks to be reassembled at the destination.
3. Key protocols: **TCP** (reliable, connection-oriented) and **UDP** (fast, connectionless).
#### 1.2.3.5	Layer 5 – Session
1. Establishes, maintains, and terminates communication sessions between devices.
2. Handles **authentication, reconnection, and checkpoints** to resume interrupted transfers.
3. Coordinates the exchange of information between the Presentation layer (6) and Transport layer (4).
#### 1.2.3.6	Layer 6 – Presentation
1. Responsible for **data translation, encryption, and compression** so applications can understand the data.
2. Ensures that data sent can be properly interpreted by the receiving system.
3. Example: **SSL/TLS** encrypts data in HTTPS connections.
#### 1.2.3.7	Layer 7 – Application
1. Closest layer to the user: enables applications to access network services.
2. Uses protocols such as **HTTP/HTTPS, SMTP, DNS** for web browsing, email, and name resolution.
3. Provides direct interaction between user software and internet servers.
## 1.3	Local and wide network communication
### 1.3.1	Internet Protocol (IP) Address
A unique string of characters that identifies the location of a device on the internet
There are two types:
- **IPv4**
- **IPv6**
	- 32 characters
IPs can be also:
- **Public**: IP assigned by the Internet Service Provider (ISP), shared by all devices within a LAN)
- **Private**: Only seen by the devices in the same LAN

IPv4 Header Fields (13)
![[image-2.png|555x340]]
### 1.3.2	MAC Address
Unique alphanumeric identifier that is assigned to each physical device on a network
The switch associates each MAC Address with a port number, listed in an address table

# 2	Network Operations

## 2.1	Network protocols
Set of rules used by two or more devices on a network to describe the order of delivery and the structure of the data.

Communications are needed to establish connections.
This communications are made with protocols, for example, to access a web, at least 4 protocols are going to be used:
- TCP to establish the connection
- ARP to determine the route of the data
- HTTPS to communicate with the web
- DNS to know which IP address does the web have
### 2.1.1	Communication Protocols

#### 2.1.1.1	Transmission Control Protocol (TCP)
- An internet communications protocol that allows two or more devices to form a connection and stream data.
- It also verifies both devices before allowing any further communications to take place: *the handshake*.
#### 2.1.1.2	User Datagram Protocol (UDP)
It is a *connectionless* protocol that does not establish a connection between devices before a transmission. This makes it *less reliable than TCP*. But it also means that it works well for transmissions that need to get to their destination quickly.
#### 2.1.1.3	Address Resolution Protocol (ARP)
A network protocol used to determine the MAC address of the next router or device on the path.
#### 2.1.1.4	HyperText Transfer Protocol Secure (HTTPS) - Communication and security Protocol
A network protocol that provides a secure method of communication between clients and website servers.
It uses port *443*.
It uses SSL/TLS to encrypt data, so it is more secure than HTTP, which is *port 80*.
#### 2.1.1.5	Domain Name System (DNS)
Network Protocol that translates internet domain names into IP addresses.
It uses *port 53*.
### 2.1.2	Management Protocols
#### 2.1.2.1	Simple Network Management Protocol (SNMP)
Used for:
- Monitoring and managing devices on a network
- Reset password on a network device or change its baseline configuration
- Send requests to network devices
Works at the application layer
#### 2.1.2.2	Internet Control Message Protocol (ICMP)
Used for:
- Data transmission errors communication
- Troubleshoot network connectivity

### 2.1.3	Security Protocols
#### 2.1.3.1	HTTPS
#### 2.1.3.2	Secure File Transfer Protocol (SFTP)
Transfer device to another on a network.
Uses secure shell, usually on *port 22*.

### 2.1.4	Additional protocols
- Network Address Translation
- Dynamic Host Configuration Protocol -> UDP Port 67 (servers), UDP Port 68 (Clients)
- Telnet -> TCP port 23
- Secure shell -> TCP port 22 
- Post Office Protocol -> TCP/UDP port 110 (unencrypted), TCP/UDP port 995 (SSL/TLS)
- Internet Message Access Protocol -> TCP port 143 (unencrypted), TCP port 993 (SSL/TLS)
- Simple Mail Transfer Protocol -> TCP/UDP port 25 (unencrypted), TCP/UDP port 587 (TLS)

### 2.1.5	Wireless Protocols
#### 2.1.5.1	IEEE 802.11 (WiFi)
A set of standards that define communication for wireless LANs.
- **Wifi Protected Access** (WPA):  Wireless security protocol for devices to connect to the internet.
	- It has evolved with improved security and encryption to WPA2 and WPA3

## 2.2	Firewalls and network security measures
### 2.2.1	Firewall
A network security device that monitors traffic to and from your network
- **Port filtering**

- **Hardware Firewall:** Most basic defense in the network
- **Software Firewall:** Additional advanced defense, cheaper but more process-cost
- **Cloud-based firewalls**

- **Stateful**: Keeps track of information passing through it and proactively filters out threats
- **Stateless:** Doesn't keep track of information from data packets, works on predefined rules (less secure)

- **Next Generation Firewall**
	- Deep packet inspection
	- Intrusion protection
	- Threat intelligence
### 2.2.2	Virtual private networks (VPNs)
A network security service that *changes your public IP address* and hides your virtual location so that you can keep your data private when you are using a public network like the internet.
It also *encrypts* and *encapsulates* data,

- **WireGuard** VPN: for site-to-site connections and remote access
- **IPSec** VPN: for site-to-site connections
### 2.2.3	Security Zone
A segment of a network that protects the internal network from the internet.
- **Segmentation:** A security technique that divides the network into segments, where each segment has its own permissions and security rules
Additionally, an organization's network can be divided in subnetworks, or "*subnets*". With this, if a subnet is hacked, it can be isolated from the other subnets.
#### 2.2.3.1	Types of security zones
- **Uncontrolled Zone**: any network outside of the organization's control
- **Controlled Zone:** A subnet that protects the internal network from the uncontrolled zone
	- Demilitarized zone (DMZ): outermost layer, with public facing services that can access the uncontrolled zone
		- It is between two firewalls: the internet firewall, and the internal network firewall
	- Internal network: private servers and data
	- Restricted zone: inside the internal network, for highly private data, protected with another firewall
#### 2.2.3.2	Classless Inter-Domain Routing (CIDR)
Method of assigning subnet masks to IP addresses to create a subnet
It increases the IPv4 addresses by adding a slash ("/") followed by the IP network prefix -> 198.51.100.0/24
### 2.2.4	Proxy servers
Server that fulfills the requests of a client by forwarding them on to other servers.
They are servers that stay between the client and the internet, with their own IP address, so they hide the client IP address
#### 2.2.4.1	Types
- **Forward** proxy server: regulates and restricts a person's access to the internet
- **Reverse** proxy server: regulates and restricts the internet's access to an internal server
- **Email** proxy server: filters spam email, reducing phishing attempts

# 3	Secure Against Network Intrusions
## 3.1	Introduction to Network Intrusion Tactics
### 3.1.1	Common Network Intrusion attacks
- Malware
- Spoofing
- Packet sniffing
- Packet flooding
### 3.1.2	Organization's harms due to attacks
- Leaking valuable or confidential information
- Damaging an organization's reputation
- Impacting customer retention
- Costing money and time
- Public safety
### 3.1.3	System Compromised by Intrusions
#### 3.1.3.1	Network interception attacks
Traffic interception for information stealing, or interfering with the transmission in some way, like altering it.
This is called *packet sniffing*.
#### 3.1.3.2	Backdoor attacks
Attackers install a backdoor after they've compromised an organization, so they gain persistent access.
## 3.2	Secure Networks Against Denial of Service (DoS) Attacks
A DoS Attack targets a network or server and floods it with network traffic, overloading the server.

A **DDoS** is a **Distributed** denial of service, similar to the previous one, but the attack uses multiple devices or servers in different locations to target the network.
### 3.2.1	Common network DoS attacks
#### 3.2.1.1	SYN (synchronize) flood attack
These are the steps in a TCP handshake:
- Client sends a **SYN** to the server
- Server responds with a **SYN/ACK**
- Client responds to the server with and **ACK**
After these steps, a TCP connection is established.

This type of DoS attack that simulates a TCP connection and floods a server with SYN packets.
#### 3.2.1.2	Internet Control Message Protocol (ICMP) flood attack
ICMP is a protocol used by devices to tell each other about data transmission errors across the network.
This attack is a DoS attack where ICMP packets are repeatedly sent to a network server.
#### 3.2.1.3	Ping of death
A type of DoS attack caused when a hacker pings a system by sending it an oversized ICMP packet that is bigger than 64KB
### 3.2.2	Detect network DoS attacks
We can detect this attacks with a packet sniffer or with a packet analyzers. Some of them are:
- Wireshark
- Tcpdump
- Snort
## 3.3	Network Attack Tactics and Defense
### 3.3.1	Malicious packet sniffing
By observing the traffic, hackers can observe, steal and modify data
- **Passive**: read data packets in transit
- **Active**: data packets are manipulated in transit
#### 3.3.1.1	Protect against packet sniffing
- Use a **VPN** tunnel to encrypt and encapsulate data, so it travels safely
- Using only **HTTPS** webs
- Avoid using **unprotected WiFi**
### 3.3.2	IP Spoofing
A network attack where the attacker **changes the source IP** of the data packet to impersonate an authorized system **and gain access** to a network.
#### 3.3.2.1	Common IP Spoofing attacks
- **On-path** attack
	- Data is intercepted or altered in the middle of the authorized connection. 
	- Knowing the IP and MAC addresses of the authorized party, the attacker can pretend to be both participants
- **Replay** attack
	- The data packet is intercepted and delayed or sent again by the attacker
- **Smurf** attack
	- Sniff an authorized user's IP address and flood it with packets, like a DoS attack
#### 3.3.2.2	Protect against IP spoofing
- **Encrypt** data so even if it is intercepted, it can't be readable. Example: TLS encryption
- **Firewall** configured to decline incoming data from the internet where the IP address is the same as the private or local network.
# 4	Security Hardening
## 4.1	Introduction to security hardening
**Security Hardening** is the process of strengthening a system to reduce its vulnerability and attack surface.
**Attack surface** is all the potencial vulnerabilities that a threat actor could exploit.
### 4.1.1	Security hardening is applied in
- Devices (Hardware)
- Operating systems
- Applications
- Computer networks
- Databases
- Cloud infrastructure
#### 4.1.1.1	Physical security hardening
- Security cameras
- Security guards
### 4.1.2	Security hardening responsibilities
- Patch updates
- Backups
- Device configuration
- Encryption
- Removing or disabling unused application services
- Penetration testing
## 4.2	OS Hardening
**Operating system** is the interface between the computer hardware and the user.
There are OS hardening practices that are done regularly, and there are others just performed once.
### 4.2.1	Regular OS hardening practices
#### 4.2.1.1	Patch update
They should be made *as soon as the update is released*.
When de update is done, we should apply the **Baseline Configuration**:
- The documented set of specifications within a system, used as a basis for future builds, releases and updates
#### 4.2.1.2	Hardware and software disposal
Unused hardware and software should be removed properly
#### 4.2.1.3	Strong password policy
- Minimum characters
- Character types
- Add multi-factor authentication (MFA)
	- Something you know
	- Something you have
	- Something unique about you
#### 4.2.1.4	Virtual Machines (VMs)
To test new features or open unknown files, we can use virtual machines or sandbox environments. If anything goes wrong, we just have to remove the VM and install it again, so the damage is prevented.

### 4.2.2	Prevent brute force attacks
- Salting and hashing
- MFA
- CAPTCHA and reCAPTCHA
- Password policies
## 4.3	Network Hardening
Focuses on:
- Port filtering
- Network access privilege
- Encryption
### 4.3.1	Tasks regularly performed
- Firewall rules maintenance
- Network log analysis
	- Usually with packet sniffers or SIEMs: SIEMs list alerts in lists of priorities from high to low.
- Patch updates
- Server backups
- Install Intrusion Detection Systems (IDS) and Intrusion Prevention Systems (IPS)
### 4.3.2	Tasks performed once
And then updated as needed
- Port filtering on firewalls
- Network access privileges
- Encryption for communication
#### 4.3.2.1	Port filtering
Used to limit unwanted communication.
*Only needed ports should be allowed*, the remaining should be disallowed.
- Update protocols in Wireless networks
- Disable older protocols
#### 4.3.2.2	Network segmentation
To create an *isolated subnet for every department* the organization.
Also, to *create restricted zones* with restricted access privileges
#### 4.3.2.3	Update encryption standards
The more restricted is the zone, the higher encryption it should have.
## 4.4	Cloud Hardening
A **cloud network** is a collection of servers or computers that stores resources and data in remote data centers that can be accessed via the internet.
### 4.4.1	Server baseline image
It is a fixed reference point.
In cloud network hardening, a *server baseline image* is used in all the server instances stored in the cloud.
- This allows to compare data in the cloud service to de baseline image, and ensure that unverified changes haven't been made.
### 4.4.2	Cloud segmentation
- **Older** applications should kept separate from **newer** applications.
- **Internal functions** should be kept separate from **front-end** applications
### 4.4.3	Cloud security considerations
- **Identity access management**: manage digital entities, users and roles
- **Configuration**: misconfiguration is a frequent source of security breaches
- Reduce **attack surface**
- Stay up to date with **zero-day attacks**
- **Visualize** **and** **track** data in the network
- Cloud is a **fast-changing** environment
- **Shared responsibility model**: *Cloud Service Providers* (CSP) take responsibility for *cloud infrastructure security*, whereas *the company using the cloud services* takes responsibility for the *assets and processes that they store or operate in the cloud*
### 4.4.4	Cloud security hardening
- **Hypervisors**: they abstract the host's hardware from the operating software environment.
- **Identity access management**
- **Baselining**
- **Cryptography in the cloud**
- **Crypctographic erasure**
- **Key management**